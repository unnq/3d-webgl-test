<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>A-Frame Demo — Neon Gallery</title>

  <!-- A-Frame (stable) -->
  <script src="https://aframe.io/releases/1.7.1/aframe.min.js"></script>
  <!-- glTF animation mixer (safe to include; harmless if no animations) -->
  <script src="https://cdn.jsdelivr.net/npm/aframe-extras.animation-mixer@6.1.1/dist/aframe-extras.animation-mixer.min.js"></script>

  <style>
    html, body { height:100%; margin:0; background:#0b0c10; }
    .topbar { position:fixed; left:0; right:0; top:0; height:48px; display:flex; align-items:center; gap:12px; padding:0 12px;
              background:rgba(11,12,16,.65); backdrop-filter:blur(6px); border-bottom:1px solid rgba(255,255,255,.08); z-index:5; color:#e5ecff; }
    .topbar a { color:#e5ecff; text-decoration:none; opacity:.9 }
    .note { position:fixed; right:10px; bottom:10px; color:#aab3c7; font:14px/1.4 ui-sans-serif,system-ui; }
    a-scene { height:100%; }
  </style>
</head>
<body>
  <div class="topbar">
    <a href="./">← Back</a>
    <strong>A-Frame Demo</strong>
  </div>

  <!-- Minimal, deterministic scene -->
  <a-scene renderer="colorManagement: true" xr-mode-ui="XRMode: xr">
    <!-- (1) Box sanity check so you instantly see *something* render -->
    <a-box id="debugBox" position="-1 1 -3" depth="1" height="1" width="1" color="#4CC3D9"></a-box>

    <!-- adds a mouse to scene so one can click -->
    <a-entity id="mouseCursor"
          cursor="rayOrigin: mouse"
          raycaster="objects: .clickable; far: 20">
    </a-entity>

    <!-- (2) Load a single-file GLB directly via URL -->
    <a-entity id="product"
              class="clickable"
              gltf-model="url(https://raw.githubusercontent.com/KhronosGroup/glTF-Sample-Models/master/2.0/BoomBox/glTF-Binary/BoomBox.glb)"
              position="0 1 -2"
              rotation="0 30 0"
              scale="5 5 5"
              animation-mixer>
    </a-entity>

    <!-- hotspot link feature -->
    <a-plane id="hotspot1"
         class="clickable"
         position="0 2 -2"
         width="0.9" height="0.3"
         material="color: #7aa2ff; shader: flat; opacity: 0.95"
         text="value: Visit Neon Gallery; align: center; color: #0b0c10; width: 4">
    </a-plane>

    <!-- aframe link technique -->
    <a-entity position="1 1.4 -2"
              geometry="primitive: plane; width: 1.6; height: 0.9"
              material="shader: flat; src: https://images.unsplash.com/photo-1501594907352-04cda38ebc29?w=800"
              link="href: ./aframe.html; title: A-Frame Demo; on: click"
              class="clickable">
    </a-entity>

    <!-- Camera rig (WASD + mouse to look) -->
    <a-entity id="rig" position="0 1.6 4">
      <a-entity camera look-controls wasd-controls></a-entity>
    </a-entity>

    <!-- Lights -->
    <a-entity light="type: ambient; intensity: 0.35; color: #ffffff"></a-entity>
    <a-entity light="type: directional; intensity: 1.6; color: #ffffff" position="2 4 3"></a-entity>

    <!-- Simple ground + sky (visible on desktop; auto-hidden by XR anyway) -->
    <a-circle radius="12" color="#0f1117" rotation="-90 0 0" position="0 0 -2"></a-circle>
    <a-sky color="#0f1117"></a-sky>

    <!-- (3) Helpful console logs -->
    <a-entity id="logger"
      script="data:dummy"></a-entity>
  </a-scene>

  <div class="note">Drag to look • WASD to move • Press <kbd>Ctrl</kbd>+<kbd>Alt</kbd>+<kbd>I</kbd> for the A-Frame Inspector.</div>

<script>
  const product = document.getElementById('product');   // your GLB entity
  const hotspot = document.getElementById('hotspot1');  // optional

  // keep original scales per element
  const baseScale = new WeakMap();

  function ensureBase(el) {
    if (!baseScale.has(el)) {
      baseScale.set(el, el.object3D.scale.clone());
    }
  }

  function hoverOn(el, factor = 1.05) {
    ensureBase(el);
    const base = baseScale.get(el);
    el.object3D.scale.set(base.x * factor, base.y * factor, base.z * factor);
    document.body.style.cursor = 'pointer';
  }

  function hoverOff(el) {
    const base = baseScale.get(el);
    if (base) el.object3D.scale.copy(base);
    document.body.style.cursor = '';
  }

  [product, hotspot].forEach(el => {
    if (!el) return;
    // If the model loads asynchronously, capture base AFTER it’s in the scene
    el.addEventListener('model-loaded', () => baseScale.set(el, el.object3D.scale.clone()));
    el.addEventListener('mouseenter', () => hoverOn(el, 1.05));
    el.addEventListener('mouseleave', () => hoverOff(el));
  });
</script>
  
  <script>
    // (3) Log load status / errors so we know exactly what's happening.
    const product = document.getElementById('product');
    product.addEventListener('model-loaded', e => {
      console.log('[A-Frame] model-loaded:', e.detail);
      // Centering/scale safety (optional): ensure it’s in front of the camera
      product.object3D.position.set(0, 1, -2);
      product.object3D.scale.setScalar(2);
    });
    product.addEventListener('model-error', e => {
      console.error('[A-Frame] model-error:', e.detail);
    });
  </script>
</body>
</html>
